/*
 * Copyright (c) 2023 European Commission
 *
 * Licensed under the EUPL, Version 1.2 or - as soon they will be approved by the European
 * Commission - subsequent versions of the EUPL (the "Licence"); You may not use this work
 * except in compliance with the Licence.
 *
 * You may obtain a copy of the Licence at:
 * https://joinup.ec.europa.eu/software/page/eupl
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the Licence is distributed on an "AS IS" basis, WITHOUT WARRANTIES OR CONDITIONS OF
 * ANY KIND, either express or implied. See the Licence for the specific language
 * governing permissions and limitations under the Licence.
 */

package eu.europa.ec.testfeature

import eu.europa.ec.eudi.wallet.document.IssuedDocument
import eu.europa.ec.eudi.wallet.document.UnsignedDocument
import java.time.Instant

const val mockedGenericErrorMessage = "resourceProvider's genericErrorMessage"
const val mockedPlainFailureMessage = "failure message"

val mockedExceptionWithMessage = RuntimeException("Exception to test interactor.")
val mockedExceptionWithNoMessage = RuntimeException()

const val mockedOldestDocumentCreationDate = "2000-01-25T14:25:00.073Z"
const val mockedDocumentCreationDate = "2024-01-25T14:25:00.073Z"
const val mockedOldestPidId = "000000"
const val mockedPidId = "000001"
const val mockedMdlId = "000002"
const val mockedPidDocName = "EU PID"
const val mockedMdlDocName = "mDL"
const val mockedVerifierIsTrusted = true
val mockedPidFields: Map<String, ByteArray> = mapOf(
    "family_name" to byteArrayOf(105, 65, 78, 68, 69, 82, 83, 83, 79, 78),
    "given_name" to byteArrayOf(99, 74, 65, 78),
    "birth_date" to byteArrayOf(-39, 3, -20, 106, 49, 57, 56, 53, 45, 48, 51, 45, 51, 48),
    "age_over_18" to byteArrayOf(-11),
    "age_over_15" to byteArrayOf(-11),
    "age_over_21" to byteArrayOf(-11),
    "age_over_60" to byteArrayOf(-12),
    "age_over_65" to byteArrayOf(-12),
    "age_over_68" to byteArrayOf(-12),
    "age_in_years" to byteArrayOf(24, 38),
    "age_birth_year" to byteArrayOf(25, 7, -63),
    "family_name_birth" to byteArrayOf(105, 65, 78, 68, 69, 82, 83, 83, 79, 78),
    "given_name_birth" to byteArrayOf(99, 74, 65, 78),
    "birth_place" to byteArrayOf(102, 83, 87, 69, 68, 69, 78),
    "birth_country" to byteArrayOf(98, 83, 69),
    "birth_state" to byteArrayOf(98, 83, 69),
    "birth_city" to byteArrayOf(107, 75, 65, 84, 82, 73, 78, 69, 72, 79, 76, 77),
    "resident_address" to byteArrayOf(
        111,
        70,
        79,
        82,
        84,
        85,
        78,
        65,
        71,
        65,
        84,
        65,
        78,
        32,
        49,
        53
    ),
    "resident_country" to byteArrayOf(98, 83, 69),
    "resident_state" to byteArrayOf(98, 83, 69),
    "resident_city" to byteArrayOf(107, 75, 65, 84, 82, 73, 78, 69, 72, 79, 76, 77),
    "resident_postal_code" to byteArrayOf(101, 54, 52, 49, 51, 51),
    "resident_street" to byteArrayOf(108, 70, 79, 82, 84, 85, 78, 65, 71, 65, 84, 65, 78),
    "resident_house_number" to byteArrayOf(98, 49, 50),
    "gender" to byteArrayOf(1),
    "nationality" to byteArrayOf(98, 83, 69),
    "issuance_date" to byteArrayOf(
        -64,
        116,
        50,
        48,
        48,
        57,
        45,
        48,
        49,
        45,
        48,
        49,
        84,
        48,
        48,
        58,
        48,
        48,
        58,
        48,
        48,
        90
    ),
    "expiry_date" to byteArrayOf(
        -64,
        116,
        50,
        48,
        53,
        48,
        45,
        48,
        51,
        45,
        51,
        48,
        84,
        48,
        48,
        58,
        48,
        48,
        58,
        48,
        48,
        90
    ),
    "issuing_authority" to byteArrayOf(99, 85, 84, 79),
    "document_number" to byteArrayOf(105, 49, 49, 49, 49, 49, 49, 49, 49, 52),
    "administrative_number" to byteArrayOf(106, 57, 48, 49, 48, 49, 54, 55, 52, 54, 52),
    "issuing_country" to byteArrayOf(98, 83, 69),
    "issuing_jurisdiction" to byteArrayOf(100, 83, 69, 45, 73),
)
val mockedMdlFields: Map<String, ByteArray> = mapOf(
    "family_name" to byteArrayOf(105, 65, 78, 68, 69, 82, 83, 83, 79, 78),
    "given_name" to byteArrayOf(99, 74, 65, 78),
    "birth_date" to byteArrayOf(-39, 3, -20, 106, 49, 57, 56, 53, 45, 48, 51, 45, 51, 48),
    "issue_date" to byteArrayOf(
        -64,
        116,
        50,
        48,
        48,
        57,
        45,
        48,
        49,
        45,
        48,
        49,
        84,
        48,
        48,
        58,
        48,
        48,
        58,
        48,
        48,
        90
    ),
    "expiry_date" to byteArrayOf(
        -64,
        116,
        50,
        48,
        53,
        48,
        45,
        48,
        51,
        45,
        51,
        48,
        84,
        48,
        48,
        58,
        48,
        48,
        58,
        48,
        48,
        90
    ),
    "issuing_country" to byteArrayOf(98, 83, 69),
    "issuing_authority" to byteArrayOf(99, 85, 84, 79),
    "document_number" to byteArrayOf(105, 49, 49, 49, 49, 49, 49, 49, 49, 52),
    "portrait" to byteArrayOf(98, 83, 69),
    "driving_privileges" to byteArrayOf(
        -126,
        -93,
        106,
        105,
        115,
        115,
        117,
        101,
        95,
        100,
        97,
        116,
        101,
        -39,
        3,
        -20,
        106,
        50,
        48,
        49,
        48,
        45,
        48,
        55,
        45,
        48,
        49,
        107,
        101,
        120,
        112,
        105,
        114,
        121,
        95,
        100,
        97,
        116,
        101,
        -39,
        3,
        -20,
        106,
        50,
        48,
        53,
        48,
        45,
        48,
        51,
        45,
        51,
        48,
        117,
        118,
        101,
        104,
        105,
        99,
        108,
        101,
        95,
        99,
        97,
        116,
        101,
        103,
        111,
        114,
        121,
        95,
        99,
        111,
        100,
        101,
        97,
        65,
        -93,
        106,
        105,
        115,
        115,
        117,
        101,
        95,
        100,
        97,
        116,
        101,
        -39,
        3,
        -20,
        106,
        50,
        48,
        48,
        56,
        45,
        48,
        53,
        45,
        49,
        57,
        107,
        101,
        120,
        112,
        105,
        114,
        121,
        95,
        100,
        97,
        116,
        101,
        -39,
        3,
        -20,
        106,
        50,
        48,
        53,
        48,
        45,
        48,
        51,
        45,
        51,
        48,
        117,
        118,
        101,
        104,
        105,
        99,
        108,
        101,
        95,
        99,
        97,
        116,
        101,
        103,
        111,
        114,
        121,
        95,
        99,
        111,
        100,
        101,
        97,
        66
    ),
    "un_distinguishing_sign" to byteArrayOf(97, 83),
    "administrative_number" to byteArrayOf(106, 57, 48, 49, 48, 49, 54, 55, 52, 54, 52),
    "sex" to byteArrayOf(1),
    "height" to byteArrayOf(24, -76),
    "weight" to byteArrayOf(24, 91),
    "eye_colour" to byteArrayOf(101, 98, 108, 97, 99, 107),
    "hair_colour" to byteArrayOf(101, 98, 108, 97, 99, 107),
    "birth_place" to byteArrayOf(102, 83, 87, 69, 68, 69, 78),
    "resident_address" to byteArrayOf(
        111,
        70,
        79,
        82,
        84,
        85,
        78,
        65,
        71,
        65,
        84,
        65,
        78,
        32,
        49,
        53
    ),
    "portrait_capture_date" to byteArrayOf(
        -64,
        116,
        50,
        48,
        50,
        51,
        45,
        48,
        51,
        45,
        50,
        51,
        84,
        48,
        48,
        58,
        48,
        48,
        58,
        48,
        48,
        90
    ),
    "signature_usual_mark" to byteArrayOf(98, 83, 69),
    "age_in_years" to byteArrayOf(24, 38),
    "age_birth_year" to byteArrayOf(25, 7, -63),
    "issuing_jurisdiction" to byteArrayOf(100, 83, 69, 45, 73),
    "nationality" to byteArrayOf(98, 83, 69),
    "resident_city" to byteArrayOf(102, 83, 87, 69, 68, 69, 78),
    "resident_state" to byteArrayOf(98, 83, 69),
    "resident_postal_code" to byteArrayOf(101, 54, 52, 49, 51, 51),
    "resident_country" to byteArrayOf(98, 83, 69),
    "family_name_national_character" to byteArrayOf(
        105,
        65,
        78,
        68,
        69,
        82,
        83,
        83,
        79,
        78
    ),
    "given_name_national_character" to byteArrayOf(99, 74, 65, 78),
    "age_over_15" to byteArrayOf(-11),
    "age_over_18" to byteArrayOf(-11),
    "age_over_21" to byteArrayOf(-11),
    "age_over_60" to byteArrayOf(-12),
    "age_over_65" to byteArrayOf(-12),
    "age_over_68" to byteArrayOf(-12),
)

val mockedPidBasicFields: Map<String, ByteArray> = mapOf(
    "family_name" to byteArrayOf(105, 65, 78, 68, 69, 82, 83, 83, 79, 78),
    "given_name" to byteArrayOf(99, 74, 65, 78),
    "age_over_18" to byteArrayOf(-11),
    "age_over_65" to byteArrayOf(-12),
    "age_birth_year" to byteArrayOf(25, 7, -63),
    "birth_city" to byteArrayOf(107, 75, 65, 84, 82, 73, 78, 69, 72, 79, 76, 77),
    "gender" to byteArrayOf(1),
    "expiry_date" to byteArrayOf(
        -64,
        116,
        50,
        48,
        53,
        48,
        45,
        48,
        51,
        45,
        51,
        48,
        84,
        48,
        48,
        58,
        48,
        48,
        58,
        48,
        48,
        90
    ),
)

val mockedMdlBasicFields: Map<String, ByteArray> = mapOf(
    "family_name" to byteArrayOf(105, 65, 78, 68, 69, 82, 83, 83, 79, 78),
    "given_name" to byteArrayOf(99, 74, 65, 78),
    "birth_place" to byteArrayOf(102, 83, 87, 69, 68, 69, 78),
    "expiry_date" to byteArrayOf(
        -64,
        116,
        50,
        48,
        53,
        48,
        45,
        48,
        51,
        45,
        51,
        48,
        84,
        48,
        48,
        58,
        48,
        48,
        58,
        48,
        48,
        90
    ),
    "portrait" to byteArrayOf(98, 83, 69),
    "driving_privileges" to byteArrayOf(
        -126,
        -93,
        106,
        105,
        115,
        115,
        117,
        101,
        95,
        100,
        97,
        116,
        101,
        -39,
        3,
        -20,
        106,
        50,
        48,
        49,
        48,
        45,
        48,
        55,
        45,
        48,
        49,
        107,
        101,
        120,
        112,
        105,
        114,
        121,
        95,
        100,
        97,
        116,
        101,
        -39,
        3,
        -20,
        106,
        50,
        48,
        53,
        48,
        45,
        48,
        51,
        45,
        51,
        48,
        117,
        118,
        101,
        104,
        105,
        99,
        108,
        101,
        95,
        99,
        97,
        116,
        101,
        103,
        111,
        114,
        121,
        95,
        99,
        111,
        100,
        101,
        97,
        65,
        -93,
        106,
        105,
        115,
        115,
        117,
        101,
        95,
        100,
        97,
        116,
        101,
        -39,
        3,
        -20,
        106,
        50,
        48,
        48,
        56,
        45,
        48,
        53,
        45,
        49,
        57,
        107,
        101,
        120,
        112,
        105,
        114,
        121,
        95,
        100,
        97,
        116,
        101,
        -39,
        3,
        -20,
        106,
        50,
        48,
        53,
        48,
        45,
        48,
        51,
        45,
        51,
        48,
        117,
        118,
        101,
        104,
        105,
        99,
        108,
        101,
        95,
        99,
        97,
        116,
        101,
        103,
        111,
        114,
        121,
        95,
        99,
        111,
        100,
        101,
        97,
        66
    ),

    "signature_usual_mark" to byteArrayOf(98, 83, 69),
    "sex" to byteArrayOf(1),
)

const val mockedPidDocType = "eu.europa.ec.eudi.pid.1"
const val mockedPidNameSpace = "eu.europa.ec.eudi.pid.1"
const val mockedMdlDocType = "org.iso.18013.5.1.mDL"
const val mockedMdlNameSpace = "org.iso.18013.5.1"

val mockedFullPid = IssuedDocument(
    id = mockedPidId,
    docType = mockedPidDocType,
    name = mockedPidDocName,
    usesStrongBox = false,
    createdAt = Instant.parse(mockedDocumentCreationDate),
    issuedAt = Instant.parse(mockedDocumentCreationDate),
    requiresUserAuth = false,
    nameSpacedData = mapOf(
        mockedPidNameSpace to mockedPidFields
    )
)

val mockedUnsignedPid = UnsignedDocument(
    id = mockedPidId,
    name = mockedPidDocName,
    docType = mockedPidDocType,
    usesStrongBox = false,
    requiresUserAuth = false,
    createdAt = Instant.parse(mockedDocumentCreationDate),
    certificatesNeedAuth = listOf()
)

val mockedMainPid = mockedFullPid

val mockedPidWithBasicFields = mockedFullPid.copy(
    nameSpacedData = mapOf(
        mockedPidNameSpace to mockedPidBasicFields
    )
)

val mockedOldestPidWithBasicFields = mockedPidWithBasicFields.copy(
    id = mockedOldestPidId,
    createdAt = Instant.parse(mockedOldestDocumentCreationDate)
)

val mockedEmptyPid = mockedFullPid.copy(
    nameSpacedData = mapOf(
        mockedPidNameSpace to emptyMap()
    )
)

val mockedFullMdl = IssuedDocument(
    id = mockedMdlId,
    docType = mockedMdlDocType,
    name = mockedMdlDocName,
    usesStrongBox = false,
    createdAt = Instant.parse(mockedDocumentCreationDate),
    issuedAt = Instant.parse(mockedDocumentCreationDate),
    requiresUserAuth = false,
    nameSpacedData = mapOf(
        mockedMdlNameSpace to mockedMdlFields
    )
)

val mockedMdlWithBasicFields = mockedFullMdl.copy(
    nameSpacedData = mapOf(
        mockedMdlNameSpace to mockedMdlBasicFields
    )
)

val mockedMdlWithNoExpirationDate: IssuedDocument = mockedFullMdl.copy(
    nameSpacedData = mapOf(
        mockedMdlNameSpace to
                mockedMdlFields
                    .minus("expiry_date")
    )
)

val mockedMdlWithNoUserNameAndNoUserImage: IssuedDocument = mockedFullMdl.copy(
    nameSpacedData = mapOf(
        mockedMdlNameSpace to
                mockedMdlFields
                    .minus("given_name")
                    .minus("portrait")
    )
)

val mockedFullDocuments: List<IssuedDocument> = listOf(
    mockedFullPid, mockedFullMdl
)